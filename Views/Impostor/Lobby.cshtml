@{
    ViewData["Title"] = "Lobby de Impostores";
}

<div class="container text-center mt-5">
    <h2 class="fw-bold text-primary mb-4">CREA UNA SALA</h2>

    <!-- Crear sala -->
    <div class="card shadow p-4 mx-auto mb-5" style="max-width:400px; border-radius:1rem;">
        <span id="errorNombreCrear" class="error-message" style="display:block; color:red; font-size:0.9rem; margin-bottom:8px;"></span>
        <input type="text" id="txtNombreCrear" placeholder="Tu nombre" class="form-control mb-3 text-center" />
        <button class="btn btn-success w-100 fw-bold" onclick="crearSala()">🚀 Crear Sala</button>
    </div>

    <h2 class="fw-bold text-secondary mb-4">O UNITE A UNA CON UN CÓDIGO</h2>

    <!-- Unirse a sala -->
    <div class="card shadow p-4 mx-auto" style="max-width:400px; border-radius:1rem;">
        <span id="errorCodigoUnirse" class="error-message" style="display:block; color:red; font-size:0.9rem; margin-bottom:4px;"></span>
        <input type="text" id="txtCodigoUnirse" placeholder="Código de sala" class="form-control mb-3 text-center" />
        <span id="errorNombreUnirse" class="error-message" style="display:block; color:red; font-size:0.9rem; margin-bottom:4px;"></span>
        <input type="text" id="txtNombreUnirse" placeholder="Tu nombre" class="form-control mb-3 text-center" />
        <button class="btn btn-primary w-100 fw-bold" onclick="unirseSala()">🔑 Unirse</button>
    </div>
</div>

<!-- Popup de sala -->
<div id="popupSala" class="modal" style="color:black; border-radius:15px; background: rgba(0,0,0,0.85);">
    <div class="modal-dialog modal-dialog-centered" style="max-width:600px">
        <div class="modal-content p-4" style="border-radius:20px; background-image:url('/images/amongus.jpg'); background-size:cover; background-position:center; color:white;">
            <div id="seccionLobby" class="text-center">

                    <h3 class="fw-bold">
                        Código de sala: <span id="codigoSala" class="badge bg-light text-dark" style="font-family:sans-serif; font-weight:900"></span>
                    </h3>

                <div id="listaJugadores" class="lista-jugadores mt-4" style="max-height:200px; overflow-y:auto;"></div>

                <div class="mt-4 p-3" id="configuracionOwner" style="display:none; border:1px solid #ddd; border-radius:10px; background-color:rgba(248,249,250,0.8);">
                    <label class="mb-1 text-danger">Cantidad de impostores:</label>
                    <div class="impostor-stepper d-flex justify-content-center align-items-center">
                        <button type="button" class="stepper-btn" id="btnMenosImpostores"><i class="fas fa-minus text-danger"></i></button>
                        <span id="numImpostoresDisplay" class="mx-3 fw-bold text-danger">1</span>
                        <button type="button" class="stepper-btn" id="btnMasImpostores"><i class="fas fa-plus text-success"></i></button>
                    </div>
                    <button class="btn btn-success w-50 mt-2" onclick="iniciarPartida()">Iniciar Partida</button>
                    <span id="mensajeEsperandoInicio" class="d-block text-danger mt-2 fw-lighter fs-6"></span>
                </div>

            </div>

            <div id="contador" style="margin-top:15px; text-align:center; font-weight:bold; color:#6c757d;"></div>


            <div id="rolJugador" style="margin-top:10px; text-align:center; font-weight:bold; color:#ffc107;"></div>

            <!-- Contenedor de votación -->
            <div id="votacion" class="mt-3" style="display:none;">
                <h6 class="my-3 text-center">Votá a quien creas que es el impostor...</h6>
                <div id="listaVotacion" class="d-flex flex-wrap justify-content-center gap-2"></div>
            </div>
        </div>
    </div>
</div>

@section Scripts {

    <style>
        .error-message {
            display: none;
            font-size: 0.9rem;
            color: red;
            margin-top: 2px;
            margin-bottom: 4px;
            display: block;
        }

        .lista-jugadores ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

            .lista-jugadores ul li {
                background-color: rgba(255,255,255,0.8);
                color: black;
                font-weight: bold;
                padding: 8px 12px;
                margin: 4px 0;
                border-radius: 8px;
                width: 80%; /* se puede ajustar */
                text-align: center;
            }

        .impostor-stepper {
            font-size: 1.2rem;
        }

        .stepper-btn {
            background-color: #f8f9fa;
            border: 1px solid #ccc;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

            .stepper-btn:hover {
                background-color: #e9ecef;
            }

        .votacion h5 {
            color: white;
            margin-bottom: 10px;
        }

        .votacion button {
            min-width: 120px;
        }

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
    <script src="~/js/impostorLobby.js"></script>
}